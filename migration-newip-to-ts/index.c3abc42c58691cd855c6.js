(()=>{"use strict";var e;!function(e){e[e.unauthorized=401]="unauthorized",e[e.notFound=404]="notFound"}(e||(e={}));class t{constructor(){this.news=new class{draw(e){const t=e.length>=10?e.filter(((e,t)=>t<10)):e,s=document.createDocumentFragment(),o=document.querySelector("#newsItemTemp");t.forEach(((e,t)=>{const r=o.content.cloneNode(!0);t%2&&r.querySelector(".news__item").classList.add("alt"),r.querySelector(".news__meta-photo").style.backgroundImage=`url(${e.urlToImage||"assets/img/news_placeholder.jpg"})`,r.querySelector(".news__meta-author").textContent=e.author||e.source.name,r.querySelector(".news__meta-date").textContent=e.publishedAt.slice(0,10).split("-").reverse().join("-"),r.querySelector(".news__description-title").textContent=e.title,r.querySelector(".news__description-source").textContent=e.source.name,r.querySelector(".news__description-content").textContent=e.description,r.querySelector(".news__read-more a").setAttribute("href",e.url),s.append(r)})),document.querySelector(".news").innerHTML="",document.querySelector(".news").appendChild(s)}},this.sources=new class{draw(e){const t=document.querySelectorAll(".source__item");if(t)for(const e of t)e&&e.remove();const s=document.createDocumentFragment(),o=document.querySelector("#sourceItemTemp");e.forEach((e=>{const t=o.content.cloneNode(!0);t.querySelector(".source__item-name").textContent=e.name,t.querySelector(".source__item").setAttribute("data-source-id",e.id),s.append(t)})),document.querySelector(".sources").append(s)}}}drawNews(e){var t;const s=null!==(t=null==e?void 0:e.articles)&&void 0!==t?t:[];this.news.draw(s)}drawSources(e){var t;const s=null!==(t=null==e?void 0:e.sources)&&void 0!==t?t:[];this.sources.draw(s)}}function s(e,t,s,o=""){const r=document.createElement(t);if(null==s?void 0:s.class){const e=s.class.split(" ");r.classList.add(...e)}return(null==s?void 0:s.id)&&r.setAttribute("id",s.id),o&&(r.innerHTML=o),e.append(r),r}(new class{constructor(){this.controller=new class extends class extends class{constructor(e,t){this.baseLink=e,this.options=t}getResp({endpoint:e,options:t={}},s){this.load("GET",e,s,t)}errorHandler(t){if(!t.ok)throw t.status!==e.unauthorized&&t.status!==e.notFound||console.log(`Sorry, but there is ${t.status} error: ${t.statusText}`),Error(t.statusText);return t}makeUrl(e={},t){const s=Object.assign(Object.assign({},this.options),e);let o=`${this.baseLink}${t}?`;return Object.keys(s).forEach((e=>{o+=`${e}=${s[e]}&`})),o.slice(0,-1)}load(e,t,s,o={}){fetch(this.makeUrl(o,t),{method:e}).then(this.errorHandler).then((e=>e.json())).then((e=>s(e))).catch((e=>console.error(e)))}}{constructor(){super("https://nodenews.herokuapp.com/",{apiKey:"2e5debdad61a4b9cb982ed04656c99f7"})}}{constructor(){super(),this.view=new t}getSources(e,t){super.getResp({endpoint:"sources",options:t},e)}getNews(e,t){let s=e.target;const o=e.currentTarget;for(;s!==o;){if(s.classList.contains("source__item")){const e=s.getAttribute("data-source-id");return void(o.getAttribute("data-source")!==e&&(o.setAttribute("data-source",e),super.getResp({endpoint:"everything",options:{sources:e}},t)))}s=s.parentNode}}getFiler(){this.view=new t,document.querySelector(".button#show-news").addEventListener("click",(()=>{const e=document.querySelector(".language__selection"),t=document.querySelectorAll(".sort__type");let s;s="publishedAt";for(const e of t)e.checked&&(s=e.value);const o={language:e.value,sortBy:s};this.getSources((e=>this.view.drawSources(e)),o)}))}addActions(){const e=document.querySelector(".button-source");super.getResp({endpoint:"top-headlines",options:{country:"ua"}},(e=>this.view.drawNews(e))),e.addEventListener("click",(()=>{const e=document.querySelector("body"),t=new DocumentFragment,o=s(t,"div",{class:"zero-block"}),r=s(o,"div",{class:"blackout"}),n=s(o,"div",{class:"container__sources"}),c=s(n,"div",{class:"sources scroll-transparent"}),u=s(c,"div",{class:"sources__header"});s(u,"h3",{class:"h3"},"Source List");const i=s(u,"button",{class:"sources__close button-theme button button__medium button__text"});s(i,"span",{class:"label"},"Ã—"),this.getSources((e=>this.view.drawSources(e)));const a=()=>{c.classList.remove("show"),r.classList.remove("show"),r.addEventListener("animationend",(()=>{o.remove()}))};r.classList.add("show"),c.classList.add("show"),r.addEventListener("click",a),e.prepend(t),document.querySelector(".sources__close").addEventListener("click",a),document.querySelector(".sources").addEventListener("click",a),document.querySelector(".sources").addEventListener("click",(e=>this.getNews(e,(e=>this.view.drawNews(e)))))}));const t=document.querySelector(".button-theme");t.addEventListener("click",(()=>{t.classList.contains("current-dark")?(t.classList.remove("current-dark"),t.classList.add("current-light"),document.querySelector('link[href*="theme-dark"]').media="not all",document.querySelector('link[href*="theme-light"]').media="all"):(t.classList.remove("current-light"),t.classList.add("current-dark"),document.querySelector('link[href*="theme-dark"]').media="all",document.querySelector('link[href*="theme-light"]').media="not all")}))}},this.view=new t}start(){this.controller.addActions()}}).start()})();