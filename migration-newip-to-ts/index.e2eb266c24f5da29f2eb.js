(()=>{"use strict";var e;!function(e){e[e.unauthorized=401]="unauthorized",e[e.notFound=404]="notFound"}(e||(e={}));class t{constructor(){this.news=new class{draw(e){const t=e.length>=10?e.filter(((e,t)=>t<10)):e,s=document.createDocumentFragment(),r=document.querySelector("#newsItemTemp");t.forEach(((e,t)=>{const o=r.content.cloneNode(!0);t%2&&o.querySelector(".news__item").classList.add("alt"),o.querySelector(".news__meta-photo").style.backgroundImage=`url(${e.urlToImage||"assets/img/news_placeholder.jpg"})`,o.querySelector(".news__meta-author").textContent=e.author||e.source.name,o.querySelector(".news__meta-date").textContent=e.publishedAt.slice(0,10).split("-").reverse().join("-"),o.querySelector(".news__description-title").textContent=e.title,o.querySelector(".news__description-source").textContent=e.source.name,o.querySelector(".news__description-content").textContent=e.description,o.querySelector(".news__read-more a").setAttribute("href",e.url),s.append(o)})),document.querySelector(".news").innerHTML="",document.querySelector(".news").appendChild(s)}},this.sources=new class{draw(e){const t=document.querySelectorAll(".source__item");if(t)for(const e of t)e&&e.remove();const s=document.createDocumentFragment(),r=document.querySelector("#sourceItemTemp");e.forEach((e=>{const t=r.content.cloneNode(!0);t.querySelector(".source__item-name").textContent=e.name,t.querySelector(".source__item").setAttribute("data-source-id",e.id),s.append(t)})),document.querySelector(".sources").append(s)}}}drawNews(e){var t;const s=null!==(t=null==e?void 0:e.articles)&&void 0!==t?t:[];this.news.draw(s)}drawSources(e){var t;const s=null!==(t=null==e?void 0:e.sources)&&void 0!==t?t:[];this.sources.draw(s)}}function s(e,t,s,r=""){const o=document.createElement(t);if(null==s?void 0:s.class){const e=s.class.split(" ");o.classList.add(...e)}return(null==s?void 0:s.id)&&o.setAttribute("id",s.id),r&&(o.innerHTML=r),e.append(o),o}(new class{constructor(){this.controller=new class extends class extends class{constructor(e,t){this.baseLink=e,this.options=t}getResp({endpoint:e,options:t={}},s){this.load("GET",e,s,t)}errorHandler(t){if(!t.ok)throw t.status!==e.unauthorized&&t.status!==e.notFound||console.log(`Sorry, but there is ${t.status} error: ${t.statusText}`),Error(t.statusText);return t}makeUrl(e={},t){const s=Object.assign(Object.assign({},this.options),e);let r=`${this.baseLink}${t}?`;return Object.keys(s).forEach((e=>{r+=`${e}=${s[e]}&`})),r.slice(0,-1)}load(e,t,s,r={}){fetch(this.makeUrl(r,t),{method:e}).then(this.errorHandler).then((e=>e.json())).then((e=>s(e))).catch((e=>console.error(e)))}}{constructor(){super("https://newsapi.org/v2/",{apiKey:"2e5debdad61a4b9cb982ed04656c99f7"})}}{constructor(){super(),this.view=new t}getSources(e,t){super.getResp({endpoint:"sources",options:t},e)}getNews(e,t){let s=e.target;const r=e.currentTarget;for(;s!==r;){if(s.classList.contains("source__item")){const e=s.getAttribute("data-source-id");return void(r.getAttribute("data-source")!==e&&(r.setAttribute("data-source",e),super.getResp({endpoint:"everything",options:{sources:e}},t)))}s=s.parentNode}}getFiler(){this.view=new t,document.querySelector(".button#show-news").addEventListener("click",(()=>{const e=document.querySelector(".language__selection"),t=document.querySelectorAll(".sort__type");let s;s="publishedAt";for(const e of t)e.checked&&(s=e.value);const r={language:e.value,sortBy:s};this.getSources((e=>this.view.drawSources(e)),r)}))}addActions(){const e=document.querySelector(".button-source");super.getResp({endpoint:"top-headlines",options:{country:"ua"}},(e=>this.view.drawNews(e))),e.addEventListener("click",(()=>{const e=document.querySelector("body"),t=new DocumentFragment,r=s(t,"div",{class:"zero-block"}),o=s(r,"div",{class:"blackout"}),n=s(r,"div",{class:"container__sources"}),c=s(n,"div",{class:"sources scroll-transparent"}),i=s(c,"div",{class:"sources__header"});s(i,"h3",{class:"h3"},"Source List");const u=s(i,"button",{class:"sources__close button-theme button button__medium button__text"});s(u,"span",{class:"label"},"Ã—"),this.getSources((e=>this.view.drawSources(e)));const a=()=>{c.classList.remove("show"),o.classList.remove("show"),o.addEventListener("animationend",(()=>{r.remove()}))};o.classList.add("show"),c.classList.add("show"),o.addEventListener("click",a),e.prepend(t),document.querySelector(".sources__close").addEventListener("click",a),document.querySelector(".sources").addEventListener("click",a),document.querySelector(".sources").addEventListener("click",(e=>this.getNews(e,(e=>this.view.drawNews(e)))))}));const t=document.querySelector(".button-theme");t.addEventListener("click",(()=>{t.classList.contains("current-dark")?(t.classList.remove("current-dark"),t.classList.add("current-light"),document.querySelector('link[href*="theme-dark"]').media="not all",document.querySelector('link[href*="theme-light"]').media="all"):(t.classList.remove("current-light"),t.classList.add("current-dark"),document.querySelector('link[href*="theme-dark"]').media="all",document.querySelector('link[href*="theme-light"]').media="not all")}))}},this.view=new t}start(){this.controller.addActions()}}).start()})();